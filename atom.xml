<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><author><name>Kijima Daigo</name></author>
<title>Insomnia</title>
<generator>Emacs webfeeder.el</generator>
<link href="https://kijimad.github.io/roam"/>
<link href="https://kijimad.github.io/roam/atom.xml" rel="self"/>
<id>https://kijimad.github.io/roam/atom.xml</id>
<updated>2025-12-22T08:11:00+09:00</updated>
<entry>
  <title>KDOC 499: 0番ポートは動的割当に利用される</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org91e04a9" class="outline-2">
 <h2 id="org91e04a9"> <a href="#org91e04a9">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org91e04a9">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org7dfd574" class="outline-2">
 <h2 id="org7dfd574"> <a href="#org7dfd574">概要</a></h2>
 <div class="outline-text-2" id="text-org7dfd574">
 <p>
0番ポートは動的割当に利用される。
</p>

 <blockquote>
 <p>
0番のポートはエニーポート（any port）と呼ばれ、アプリケーションに対して、動的に別番号の空きポートを割り当てるために用意された特殊なポート番号である。
 <a href="https://ja.wikipedia.org/wiki/TCP%E3%82%84UDP%E3%81%AB%E3%81%8A%E3%81%91%E3%82%8B%E3%83%9D%E3%83%BC%E3%83%88%E7%95%AA%E5%8F%B7%E3%81%AE%E4%B8%80%E8%A6%A7">TCPやUDPにおけるポート番号の一覧 - Wikipedia</a>
</p>
</blockquote>
</div>
</div>
 <div id="outline-container-org0e9c162" class="outline-2">
 <h2 id="org0e9c162"> <a href="#org0e9c162">関連</a></h2>
 <div class="outline-text-2" id="text-org0e9c162">
 <p>
なし。
</p>

 <ul class="org-ul"> <li>追加調査: OS側のドキュメントを確認する</li>
 <li>類推:  <a href="20251029T205958--kdoc-480-route53の由来はポート番号である__essay.html#ID-20251029T205958">KDOC 480: Route53の由来はポート番号である</a>。同じくポート番号に関する話題</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251207T203931--kdoc-499-0番ポートは動的割当に利用される__permanent.html"/>
  <id>https://kijimad.github.io/roam/20251207T203931--kdoc-499-0番ポートは動的割当に利用される__permanent.html</id>
  <updated>2025-12-22T17:10:58+09:00</updated>
</entry>
<entry>
  <title>KDOC 507: DNSのルートサーバが13個なのはDNSのUDPのパケット上限が512バイトであるから</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org0e9f27b" class="outline-2">
 <h2 id="org0e9f27b"> <a href="#org0e9f27b">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org0e9f27b">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul> <ul class="org-ul"> <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgade66cc" class="outline-2">
 <h2 id="orgade66cc"> <a href="#orgade66cc">概要</a></h2>
 <div class="outline-text-2" id="text-orgade66cc">
 <p>
DNSのルートサーバは13個しかない。これはDNSにおけるUDPのパケット長の上限が512バイトであることからくる制約である(p57)。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>見てみる</label> <pre class="src src-shell">dig . NS
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">
; <<>> DiG 9.18.30-0ubuntu0.24.04.1-Ubuntu <<>> . NS
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 61072
;; flags: qr rd ra; QUERY: 1, ANSWER: 13, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;.				IN	NS

;; ANSWER SECTION:
.			7007	IN	NS	i.root-servers.net.
.			7007	IN	NS	g.root-servers.net.
.			7007	IN	NS	j.root-servers.net.
.			7007	IN	NS	b.root-servers.net.
.			7007	IN	NS	h.root-servers.net.
.			7007	IN	NS	a.root-servers.net.
.			7007	IN	NS	k.root-servers.net.
.			7007	IN	NS	d.root-servers.net.
.			7007	IN	NS	m.root-servers.net.
.			7007	IN	NS	c.root-servers.net.
.			7007	IN	NS	f.root-servers.net.
.			7007	IN	NS	l.root-servers.net.
.			7007	IN	NS	e.root-servers.net.

;; Query time: 0 msec
;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)
;; WHEN: Sun Dec 21 19:11:45 JST 2025
;; MSG SIZE  rcvd: 239

</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-shell">dig jp. NS
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">
; <<>> DiG 9.18.30-0ubuntu0.24.04.1-Ubuntu <<>> jp. NS
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 57427
;; flags: qr rd ra; QUERY: 1, ANSWER: 8, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;jp.				IN	NS

;; ANSWER SECTION:
jp.			6621	IN	NS	d.dns.jp.
jp.			6621	IN	NS	g.dns.jp.
jp.			6621	IN	NS	h.dns.jp.
jp.			6621	IN	NS	c.dns.jp.
jp.			6621	IN	NS	e.dns.jp.
jp.			6621	IN	NS	b.dns.jp.
jp.			6621	IN	NS	a.dns.jp.
jp.			6621	IN	NS	f.dns.jp.

;; Query time: 0 msec
;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)
;; WHEN: Sun Dec 21 19:16:20 JST 2025
;; MSG SIZE  rcvd: 163

</pre>
</div>
</div>
</div>
 <div id="outline-container-org9acdb57" class="outline-2">
 <h2 id="org9acdb57"> <a href="#org9acdb57">関連</a></h2>
 <div class="outline-text-2" id="text-org9acdb57">
 <ul class="org-ul"> <li>参照:  <a href="20241102T084716--kdoc-258-『ピアリング戦記』__book.html#ID-20241102T084716">KDOC 258: 『ピアリング戦記』</a>から</li>
 <li>追加調査: なぜ13個になるのか詳細を調べる</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251217T184407--kdoc-507-dnsのルートサーバが13個なのはdnsのudpのパケット上限が512バイトであるから__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20251217T184407--kdoc-507-dnsのルートサーバが13個なのはdnsのudpのパケット上限が512バイトであるから__draft_permanent.html</id>
  <updated>2025-12-22T17:10:53+09:00</updated>
</entry>
<entry>
  <title>KDOC 513: フレッツの利用者は10.0.0.0/8をローカルネットワーク内で使用できない</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orge17e7ec" class="outline-2">
 <h2 id="orge17e7ec"> <a href="#orge17e7ec">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orge17e7ec">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul> <ul class="org-ul"> <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org0d3e690" class="outline-2">
 <h2 id="org0d3e690"> <a href="#org0d3e690">概要</a></h2>
 <div class="outline-text-2" id="text-org0d3e690">
 <p>
NTTのフレッツ網は内部ネットワークでプライベートアドレス 10.0.0.0/8 を使用しているため、利用者はローカルネットワーク内で 10.0.0.0/8 を使用できない。
</p>

 <p>
プライベートIP範囲のなかでも、もっともホスト部が大きな範囲を使用している。
</p>

 <ul class="org-ul"> <li>10.0.0.0/8 (クラスA)</li>
 <li>172.16.0.0/12 (クラスB)</li>
 <li>192.168.0.0/16 (クラスC)</li>
</ul></div>
</div>
 <div id="outline-container-orgb65a498" class="outline-2">
 <h2 id="orgb65a498"> <a href="#orgb65a498">関連</a></h2>
 <div class="outline-text-2" id="text-orgb65a498">
 <ul class="org-ul"> <li>参照:  <a href="https://ja.wikipedia.org/wiki/IP%E3%82%A2%E3%83%89%E3%83%AC%E3%82%B9#ISP_Shared_Address">IPアドレス - Wikipedia</a>から</li>
 <li>疑問: なぜそうなったのか。標準仕様的に問題ないのか</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251220T210824--kdoc-513-フレッツの利用者は100008をローカルネットワーク内で使用できない__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20251220T210824--kdoc-513-フレッツの利用者は100008をローカルネットワーク内で使用できない__draft_permanent.html</id>
  <updated>2025-12-22T17:10:50+09:00</updated>
</entry>
<entry>
  <title>KDOC 512: DNSの強制セーフサーチがどのように機能しているか見る</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org280e571" class="outline-2">
 <h2 id="org280e571"> <a href="#org280e571">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org280e571">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-21 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orge8f8950" class="outline-2">
 <h2 id="orge8f8950"> <a href="#orge8f8950">概要</a></h2>
 <div class="outline-text-2" id="text-orge8f8950">
 <p>
DNSフィルタリングツールのAdGuardで、強制セーフサーチが適用されている様子を見る。
</p>

 <div class="org-src-container">
 <pre class="src src-shell">dig www.google.com
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">
; <<>> DiG 9.18.30-0ubuntu0.24.04.1-Ubuntu <<>> www.google.com
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 55983
;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;www.google.com.			IN	A

;; ANSWER SECTION:
www.google.com.		3	IN	CNAME	forcesafesearch.google.com. 👈
forcesafesearch.google.com. 3	IN	A	216.239.38.120

;; Query time: 0 msec
;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)
;; WHEN: Sat Dec 20 19:54:25 JST 2025
;; MSG SIZE  rcvd: 89

</pre>
</div>

 <p>
以下の流れのように、強制されていることがわかる。
</p>

 <ul class="org-ul"> <li>www.google.com -(CNAME)→ forcesafesearch.google.com -(A)→ 216.239.38.120</li>
</ul></div>
</div>
 <div id="outline-container-orgf38b08d" class="outline-2">
 <h2 id="orgf38b08d"> <a href="#orgf38b08d">関連</a></h2>
 <div class="outline-text-2" id="text-orgf38b08d">
 <ul class="org-ul"> <li>動機:  <a href="20241118T203644--kdoc-295-lanでdnsフィルタリングする流れを見る__permanent.html#ID-20241118T203644">KDOC 295: LANでDNSフィルタリングする流れを見る</a>。使っていて気になった</li>
 <li>追加調査: www.google.com と google.com で結果が異なる。何が違うのか</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251220T195006--kdoc-512-dnsの強制セーフサーチがどのように機能しているか見る__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20251220T195006--kdoc-512-dnsの強制セーフサーチがどのように機能しているか見る__draft_permanent.html</id>
  <updated>2025-12-22T17:10:50+09:00</updated>
</entry>
<entry>
  <title>KDOC 505: 既存メモ側からどういった関連ができそうか考える</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org42b62b7" class="outline-2">
 <h2 id="org42b62b7"> <a href="#org42b62b7">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org42b62b7">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgffdf795" class="outline-2">
 <h2 id="orgffdf795"> <a href="#orgffdf795">概要</a></h2>
 <div class="outline-text-2" id="text-orgffdf795">
 <p>
ツェッテルカステンライクな方法でメモしている。
</p>

 <p>
メモの関連が少なく、理解や思考を深められていないのを課題に感じてきた。単純に同じカテゴリの話題だから、という理由で関連させていることが多かったが、意味ないよな、と感じてきた。
</p>

 <p>
既存メモ側にどういった関連ができそうかの想定を書いておくと関連させやすいことに気づいた。また、それだけだと忘れやすいので先に想定する関連に対して類型をつけて抽象化しておくと、組み合わせて考えやすいのに気づいた。
</p>

 <pre class="example" id="org77d71ba">
KDOC 37: トップダウンかボトムアップ、どちらで成し遂げるか?
- 具体例: トップダウンの主張も出す

KDOC 71: KDOCエントリの書き方を考える
- 補足: 結局テンプレートファイルに含めた項目以外は忘れ去っていた。仕組みにしなければならない

KDOC 3: 『ない仕事の作り方』
- 組み合わせ: 彼のスクラップ癖と知識獲得モデルは、メモのとりかたで説明できるのではないか
</pre>

 <p>
そしてあとは、これらを見返して、この関連となるメモを追加していくわけである。
</p>

 <p>
いままでは膨大な既存メモと、ランダムに書いた新規メモがあって、その関連を考えていた。結果、深まらないメモができていた。事前に関連を考えておく方式だと、既存メモから考えた関連をもとにメモを作る。最初から関連ありきでメモを作成するので、深まっていくだろう。
</p>
</div>
</div>
 <div id="outline-container-orgfbc642c" class="outline-2">
 <h2 id="orgfbc642c"> <a href="#orgfbc642c">関連</a></h2>
 <div class="outline-text-2" id="text-orgfbc642c">
 <ul class="org-ul"> <li>動機:  <a href="20240502T172812--kdoc-153-すでにあるメモから、関連させられないか考える__essay.html#ID-20240502T172812">KDOC 153: すでにあるメモから、関連させられないか考える</a>。「時間を作る」だけでは改善しなかったので、対策を具体化した</li>
 <li>補足:  <a href="20231008T203658--kdoc-36-『take-notes』__book.html#ID-20231008T203658">KDOC 36: 『TAKE NOTES!』</a>。ツェッテルカステンで参考にしている本</li>
</ul></div>
</div>
 <div id="outline-container-org2ab08ad" class="outline-2">
 <h2 id="org2ab08ad"> <a href="#org2ab08ad">Backlinks</a></h2>
 <div class="outline-text-2" id="text-org2ab08ad">
 <ul class="org-ul"> <li> <a href="./20240504T224810--kdoc-165-メモの課題と対応策を考える__structure.html">KDOC 165: メモの課題と対応策を考える</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251214T123530--kdoc-505-既存メモ側からどういった関連ができそうか考える__essay.html"/>
  <id>https://kijimad.github.io/roam/20251214T123530--kdoc-505-既存メモ側からどういった関連ができそうか考える__essay.html</id>
  <updated>2025-12-22T17:10:48+09:00</updated>
</entry>
<entry>
  <title>KDOC 504: 家電売り場で栄枯盛衰を感じる</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org8e4c5db" class="outline-2">
 <h2 id="org8e4c5db"> <a href="#org8e4c5db">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org8e4c5db">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-20 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org916b10c" class="outline-2">
 <h2 id="org916b10c"> <a href="#org916b10c">概要</a></h2>
 <div class="outline-text-2" id="text-org916b10c">
 <p>
日曜の午後、池袋駅付近にある複数の大型家電店をぶらついた。あてもなく1フロアずつ練り歩いたところ、気づいたことがあった。
</p>

 <ul class="org-ul"> <li>どの店も1階にスマートフォン売り場があり、人で混雑している</li>
 <li>PC周辺機器などのIT・小型家電で1フロアになっていることが多い。テレビ、冷蔵庫、洗濯機などの大型家電で1フロアになっていることが多い</li>
 <li>テレビは広大な売り場面積を占めるが、閑散としていた。大量のテレビの音響が混ざり合ってガヤガヤした音だけが響いていた。数組の若いカップルと店員がテーブルに座って契約を進めているように見えた。明らかに大型家電にはシーズン性があるが、それを差し引いても人がいないのに驚いた。疲れて休憩がてら見る人さえいなかった。テレビは家電量販店の花形コーナーだと考えていた</li>
 <li>PC周辺機器コーナーは1フロアを占めていて、老若男女多くの人がいた</li>
 <li>カメラコーナーは広く充実しているが、あまり人はいない</li>
</ul> <p>
ひとくちに家電量販店といっても、内部では客数に大きな違いがあり、自分の持っている直感とは異なるのを体感した <sup> <a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup>。自分が何を作りたいかと、それを時代が必要としているかは別の話だ。
</p>
</div>
</div>
 <div id="outline-container-orgec6f63e" class="outline-2">
 <h2 id="orgec6f63e"> <a href="#orgec6f63e">関連</a></h2>
 <div class="outline-text-2" id="text-orgec6f63e">
 <ul class="org-ul"> <li>追加調査: 具体的に額ベースや売り場面積でジャンルごとの推移を調べる方法はあるか</li>
</ul></div>
</div>
 <div id="footnotes">
 <h2 class="footnotes">Footnotes: </h2>
 <div id="text-footnotes">

 <div class="footdef"> <sup> <a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"> <p class="footpara">
もちろん利益率が違うので、人があまり多くないように見えても利益率は高い、ということもありそうである。
</p></div></div>


</div>
</div></div>]]></content>
  <link href="https://kijimad.github.io/roam/20251213T193458--kdoc-504-家電売り場で栄枯盛衰を感じる__essay.html"/>
  <id>https://kijimad.github.io/roam/20251213T193458--kdoc-504-家電売り場で栄枯盛衰を感じる__essay.html</id>
  <updated>2025-12-22T17:10:42+09:00</updated>
</entry>
<entry>
  <title>KDOC 509: DNSフィルタリングされている様子をdigで見る</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orgba99b0c" class="outline-2">
 <h2 id="orgba99b0c"> <a href="#orgba99b0c">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orgba99b0c">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-20 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-20 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org2c3c851" class="outline-2">
 <h2 id="org2c3c851"> <a href="#org2c3c851">概要</a></h2>
 <div class="outline-text-2" id="text-org2c3c851">
 <p>
AdGuardで、DNSフィルタリングされている様子を見る。
</p>

 <p>
最初に通常のDNSレスポンスを確認する。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>通常のレスポンス</label> <pre class="src src-shell">dig google.com
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">
; <<>> DiG 9.18.30-0ubuntu0.24.04.1-Ubuntu <<>> google.com
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 20568
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;google.com.			IN	A

;; ANSWER SECTION:
google.com.		272	IN	A	172.217.174.110 👈

;; Query time: 0 msec
;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)
;; WHEN: Fri Dec 19 23:15:30 JST 2025
;; MSG SIZE  rcvd: 55

</pre>
</div>

 <p>
次に、フィルタリングされているドメインへのDNSレスポンスを確認する。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 2: </span>フィルタリング設定しているドメイン。0.0.0.0に書き換えられている</label> <pre class="src src-shell">dig x.com
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">
; <<>> DiG 9.18.30-0ubuntu0.24.04.1-Ubuntu <<>> x.com
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 7283
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags:; udp: 65494
;; QUESTION SECTION:
;x.com.				IN	A

;; ANSWER SECTION:
x.com.			10	IN	A	0.0.0.0 👈

;; Query time: 112 msec
;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)
;; WHEN: Fri Dec 19 08:58:38 JST 2025
;; MSG SIZE  rcvd: 50

</pre>
</div>
</div>
</div>
 <div id="outline-container-org74a2b46" class="outline-2">
 <h2 id="org74a2b46"> <a href="#org74a2b46">関連</a></h2>
 <div class="outline-text-2" id="text-org74a2b46">
 <ul class="org-ul"> <li>補足:  <a href="20241118T203644--kdoc-295-lanでdnsフィルタリングする流れを見る__permanent.html#ID-20241118T203644">KDOC 295: LANでDNSフィルタリングする流れを見る</a>。を補足する</li>
 <li>追加調査: AdGuardで上書きしている箇所を調べる</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251219T085723--kdoc-509-dnsフィルタリングされている様子をdigで見る__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20251219T085723--kdoc-509-dnsフィルタリングされている様子をdigで見る__draft_permanent.html</id>
  <updated>2025-12-22T17:09:58+09:00</updated>
</entry>
<entry>
  <title>KDOC 502: jsonとjsonbの性能を比較する</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org98031bb" class="outline-2">
 <h2 id="org98031bb"> <a href="#org98031bb">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org98031bb">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-20 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgf8f0eb4" class="outline-2">
 <h2 id="orgf8f0eb4"> <a href="#orgf8f0eb4">概要</a></h2>
 <div class="outline-text-2" id="text-orgf8f0eb4">
 <p>
 <a href="https://syu-m-5151.hatenablog.com/entry/2025/11/25/135220">「Postgres で試した？」と聞き返せるようになるまでもしくはなぜ私は雰囲気で技術を語るのか？ — Just use Postgres 読書感想文</a>でjsonとjsonbについて説明していた。じっさいに使ってみて読み書き性能を試してみる。
</p>

 <p>
ドキュメントのJSONデータ型の説明を見る。
</p>

 <blockquote>
 <p>
jsonデータ型は入力テキストの正確なコピーで格納し、処理関数を実行するたびに再解析する必要があります。jsonbデータ型では、分解されたバイナリ形式で格納されます。
格納するときには変換のオーバーヘッドのため少し遅くなりますが、処理するときには、全く再解析が必要とされないので大幅に高速化されます。 また jsonb型の重要な利点はインデックスをサポートしていることです。
 <a href="https://www.postgresql.jp/docs/9.6/datatype-json.html">8.14. JSONデータ型</a>
</p>
</blockquote>

 <blockquote>
 <p>
格納するときには変換のオーバーヘッドのため少し遅くなりますが、処理するときには、全く再解析が必要とされないので大幅に高速化されます。
 <a href="https://www.postgresql.jp/docs/9.6/datatype-json.html">8.14. JSONデータ型</a>
</p>
</blockquote>

 <p>
試す。
</p>

 <div class="org-src-container">
 <pre class="src src-sql"> <span class="org-keyword">CREATE</span>  <span class="org-keyword">TABLE</span>  <span class="org-function-name">users1</span> (
    test JSON
);
 <span class="org-keyword">CREATE</span>  <span class="org-keyword">TABLE</span>  <span class="org-function-name">users2</span> (
    test JSONB
);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">検証データ挿入 ================
</span>EXPLAIN ANALYZE
 <span class="org-keyword">INSERT</span>  <span class="org-keyword">INTO</span> users1 (test)
 <span class="org-keyword">SELECT</span> jsonb_build_object(
     <span class="org-string">'a'</span>, md5(random()::text)::text,
     <span class="org-string">'b'</span>, md5(random()::text)::text
)
 <span class="org-keyword">FROM</span> generate_series(1, 100000) i;

EXPLAIN ANALYZE
 <span class="org-keyword">INSERT</span>  <span class="org-keyword">INTO</span> users2 (test)
 <span class="org-keyword">SELECT</span> jsonb_build_object(
     <span class="org-string">'a'</span>, md5(random()::text)::text,
     <span class="org-string">'b'</span>, md5(random()::text)::text
)
 <span class="org-keyword">FROM</span> generate_series(1, 100000) i;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">確認
</span> <span class="org-keyword">select</span> test  <span class="org-keyword">from</span> users1  <span class="org-keyword">limit</span> 3;
 <span class="org-keyword">select</span> test  <span class="org-keyword">from</span> users2  <span class="org-keyword">limit</span> 3;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">JSON/JSONBフィールドの特定キーを取得 ================
</span>EXPLAIN ANALYZE
 <span class="org-keyword">SELECT</span> test->> <span class="org-string">'a'</span>  <span class="org-keyword">FROM</span> users1;

EXPLAIN ANALYZE
 <span class="org-keyword">SELECT</span> test->> <span class="org-string">'a'</span>  <span class="org-keyword">FROM</span> users2;
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">|                                                                                                                                       |
|---------------------------------------------------------------------------------------------------------------------------------------|
| > CREATE TABLE users1 (                                                                                                               |
| >     test JSON                                                                                                                       |
| > );                                                                                                                                  |
| CREATE TABLE                                                                                                                          |
|                                                                                                                                       |
| > CREATE TABLE users2 (                                                                                                               |
| >     test JSONB                                                                                                                      |
| > );                                                                                                                                  |
| CREATE TABLE                                                                                                                          |
|                                                                                                                                       |
| > EXPLAIN ANALYZE                                                                                                                     |
| > INSERT INTO users1 (test)                                                                                                           |
| > SELECT jsonb_build_object(                                                                                                          |
| >     'a', md5(random()::text)::text,                                                                                                 |
| >     'b', md5(random()::text)::text                                                                                                  |
| > )                                                                                                                                   |
| > FROM generate_series(1, 100000) i;                                                                                                  |
| QUERY PLAN                                                                                                                            |
| Insert on users1  (cost=0.00..3750.00 rows=0 width=0) (actual time=184.280..184.281 rows=0.00 loops=1)                                |
| Buffers: shared hit=102854 dirtied=1430 written=1432                                                                                  |
| ->  Subquery Scan on "*SELECT*"  (cost=0.00..3750.00 rows=100000 width=32) (actual time=2.514..149.198 rows=100000.00 loops=1)          |
| ->  Function Scan on generate_series i  (cost=0.00..3250.00 rows=100000 width=32) (actual time=2.508..127.342 rows=100000.00 loops=1) |
| Planning:                                                                                                                             |
| Buffers: shared hit=12                                                                                                                |
| Planning Time: 0.036 ms                                                                                                               |
| Execution Time: 184.505 ms                                                                                                            |
|                                                                                                                                       |
| > EXPLAIN ANALYZE                                                                                                                     |
| > INSERT INTO users2 (test)                                                                                                           |
| > SELECT jsonb_build_object(                                                                                                          |
| >     'a', md5(random()::text)::text,                                                                                                 |
| >     'b', md5(random()::text)::text                                                                                                  |
| > )                                                                                                                                   |
| > FROM generate_series(1, 100000) i;                                                                                                  |
| QUERY PLAN                                                                                                                            |
| Insert on users2  (cost=0.00..3250.00 rows=0 width=0) (actual time=158.466..158.467 rows=0.00 loops=1)                                |
| Buffers: shared hit=102854 dirtied=1430 written=1432                                                                                  |
| ->  Function Scan on generate_series i  (cost=0.00..3250.00 rows=100000 width=32) (actual time=2.466..123.663 rows=100000.00 loops=1) |
| Planning Time: 0.025 ms                                                                                                               |
| Execution Time: 158.657 ms                                                                                                            |
|                                                                                                                                       |
| > select test from users1 limit 3;                                                                                                    |
| test                                                                                                                                  |
| {"a": "dba001dbc53fb1affecb161244d49de5", "b": "1269bcf288fab7ff8bc8810322cf72df"}                                                    |
| {"a": "f680462287f0e413535a1d1a9e08bd9c", "b": "78082ff4cf9ac36a66da115caa675057"}                                                    |
| {"a": "ddda418ccf6b8bf7e601e3eeacd57d92", "b": "e1ab4cecb9a56acad02351bcd09ab0a9"}                                                    |
|                                                                                                                                       |
| > select test from users2 limit 3;                                                                                                    |
| test                                                                                                                                  |
| {"a": "3beeada8c14e8d4b1b137899bb26ab9e", "b": "68d8babc9da1ecc0d561d54d92f2d83e"}                                                    |
| {"a": "ac5895ccaba4305066c3539ffc199525", "b": "e0ffd0cc569d1de65334dddeb0f9afe4"}                                                    |
| {"a": "4d5ca26a018345a916c55d7aca560a84", "b": "2f068f30473bcee7650760a5c5431cb8"}                                                    |
|                                                                                                                                       |
| > EXPLAIN ANALYZE                                                                                                                     |
| > SELECT test->>'a' FROM users1;                                                                                                      |
| QUERY PLAN                                                                                                                            |
| Seq Scan on users1  (cost=0.00..3858.30 rows=194344 width=32) (actual time=0.005..16.547 rows=100000.00 loops=1)                      |
| Buffers: shared hit=1429                                                                                                              |
| Planning Time: 0.004 ms                                                                                                               |
| Execution Time: 18.648 ms                                                                                                             |
|                                                                                                                                       |
| > EXPLAIN ANALYZE                                                                                                                     |
| > SELECT test->>'a' FROM users2;                                                                                                      |
| QUERY PLAN                                                                                                                            |
| Seq Scan on users2  (cost=0.00..3858.30 rows=194344 width=32) (actual time=0.004..7.037 rows=100000.00 loops=1)                       |
| Buffers: shared hit=1429                                                                                                              |
| Planning Time: 0.008 ms                                                                                                               |
| Execution Time: 9.035 ms                                                                                                              |
</pre>
</div>

 <p>
書き込み。JSONBのほうが保存時パースする分遅い想定だったのだが、なぜかJSONBのほうが少し早い。構造の複雑さによるのだろうか。
</p>

 <ul class="org-ul"> <li>JSONフィールドの書き込み(10万件)
 <ul class="org-ul"> <li>Planning Time: 0.036 ms</li>
 <li>Execution Time: 184.505 ms</li>
</ul></li>
 <li>JSONBフィールドの書き込み(10万件)
 <ul class="org-ul"> <li>Planning Time: 0.025 ms</li>
 <li>Execution Time: 158.657 ms</li>
</ul></li>
</ul> <p>
読み出し。JSONBのほうが読み出し時にパースがないぶん早い。
</p>

 <ul class="org-ul"> <li>JSONフィールドの読み出し(10万件)
 <ul class="org-ul"> <li>Planning Time: 0.004 ms</li>
 <li>Execution Time: 18.648 ms</li>
</ul></li>
 <li>JSONBフィールドの読み出し(10万件)
 <ul class="org-ul"> <li>Planning Time: 0.008 ms</li>
 <li>Execution Time: 9.035 ms</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgcdab5b4" class="outline-2">
 <h2 id="orgcdab5b4"> <a href="#orgcdab5b4">関連</a></h2>
 <div class="outline-text-2" id="text-orgcdab5b4">
 <ul class="org-ul"> <li>追加調査: 書き込みはJSONが早いはずだが、この例だとなぜかJSONBのほうがなぜか少し早かった。複雑なJSON構造の場合はどうなるか確かめる</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251211T084518--kdoc-502-jsonとjsonbの性能を比較する__permanent.html"/>
  <id>https://kijimad.github.io/roam/20251211T084518--kdoc-502-jsonとjsonbの性能を比較する__permanent.html</id>
  <updated>2025-12-22T17:09:54+09:00</updated>
</entry>
<entry>
  <title>KDOC 515: DHCP OFFERではまだIPがないのにどうやってUDPで通信しているか?</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org44bc62c" class="outline-2">
 <h2 id="org44bc62c"> <a href="#org44bc62c">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org44bc62c">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul> <ul class="org-ul"> <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org7fb4bbb" class="outline-2">
 <h2 id="org7fb4bbb"> <a href="#org7fb4bbb">概要</a></h2>
 <div class="outline-text-2" id="text-org7fb4bbb">
 <p>
DHCP OFFERは、クライアントからのDHCP DISCOVERに対して割当可能なIPアドレスを提示する。DHCPはIPアドレスを自動設定するためのプロトコルなので、クライアントはOFFERを送った時点でIPアドレスを持っていない。
</p>

 <p>
クライアント → サーバはブロードキャストで送っているので、IPアドレスがなくても動くのはわかるが、サーバ → クライアントはどうしているのだろうか。
</p>

 <blockquote>
 <p>
DHCPサーバは、基盤となるトランスポート層のハードウェアレベルのMACアドレスを参照することができる。現在のRFCでは、DHCPパケットにクライアント識別子が指定されていない場合はトランスポート層のMACアドレスを使用できる。
 <a href="https://ja.wikipedia.org/wiki/DHCP#DHCP_offer">DHCP - Wikipedia</a>
</p>
</blockquote>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>DHCPコネクションはIPアドレスとMACアドレスの両方でハンドリングできるようになっている</label> <pre class="src src-git-permalink">https://github.com/AdguardTeam/AdGuardHome/blob/59e8c8385d1bb8239b83e5a514b524cdbcd1555e/internal/dhcpd/conn_linux.go#L34-L49
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">// dhcpConn is the net.PacketConn capable of handling both net.UDPAddr and
// net.HardwareAddr.
type dhcpConn struct {
	// udpConn is the connection for UDP addresses.
	udpConn net.PacketConn
	// bcastIP is the broadcast address specific for the configured
	// interface's subnet.
	bcastIP net.IP

	// rawConn is the connection for MAC addresses.
	rawConn net.PacketConn
	// srcMAC is the hardware address of the configured network interface.
	srcMAC net.HardwareAddr
	// srcIP is the IP address  of the configured network interface.
	srcIP net.IP
}
</pre>
</div>
</div>
</div>
 <div id="outline-container-orgd363461" class="outline-2">
 <h2 id="orgd363461"> <a href="#orgd363461">関連</a></h2>
 <div class="outline-text-2" id="text-orgd363461">
 <ul class="org-ul"> <li>参照:  <a href="https://ja.wikipedia.org/wiki/DHCP#DHCP_offer">DHCP - Wikipedia</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251221T110432--kdoc-515-dhcp-offerはまだipがないのにどうやってudpで通信しているのか__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20251221T110432--kdoc-515-dhcp-offerはまだipがないのにどうやってudpで通信しているのか__draft_permanent.html</id>
  <updated>2025-12-22T17:09:52+09:00</updated>
</entry>
<entry>
  <title>KDOC 510: DNSサーバでテストTDLを使用する例を示す</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org0a43af5" class="outline-2">
 <h2 id="org0a43af5"> <a href="#org0a43af5">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org0a43af5">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul> <ul class="org-ul"> <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orga76eeef" class="outline-2">
 <h2 id="orga76eeef"> <a href="#orga76eeef">概要</a></h2>
 <div class="outline-text-2" id="text-orga76eeef">
</div>
</div>
 <div id="outline-container-orgb3c98b0" class="outline-2">
 <h2 id="orgb3c98b0"> <a href="#orgb3c98b0">関連</a></h2>
 <div class="outline-text-2" id="text-orgb3c98b0">
 <p>
なし。
</p>
</div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251220T094534--kdoc-510-dnsサーバでテストtdlを使用する例を示す__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20251220T094534--kdoc-510-dnsサーバでテストtdlを使用する例を示す__draft_permanent.html</id>
  <updated>2025-12-22T17:09:52+09:00</updated>
</entry>
<entry>
  <title>KDOC 506: 圧倒的な量が集まってきたから好きになる</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org9ab3a0a" class="outline-2">
 <h2 id="org9ab3a0a"> <a href="#org9ab3a0a">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org9ab3a0a">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgac4760d" class="outline-2">
 <h2 id="orgac4760d"> <a href="#orgac4760d">概要</a></h2>
 <div class="outline-text-2" id="text-orgac4760d">
 <p>
 <a href="20221027T235104--kdoc-3-『ない仕事の作り方』__book.html#ID-20221027T235104">KDOC 3: 『ない仕事の作り方』</a>から、ないジャンルに名前をつけ、発表にいたるまでの流れを示す。
</p>

 <ol class="org-ol"> <li>こんな知識が何の役に立つのだろうかと考える暇を与えず、大量に摂取する</li>
 <li>好きだから集めるのではなく、圧倒的な量が集まってきたから好きになっていく</li>
 <li>「これだけ面白いものが流行らないわけがない」と自分の洗脳が進み、他人に興味を持ってもらえるようになっていく</li>
</ol></div>
</div>
 <div id="outline-container-org89a1ea4" class="outline-2">
 <h2 id="org89a1ea4"> <a href="#org89a1ea4">関連</a></h2>
 <div class="outline-text-2" id="text-org89a1ea4">
 <ul class="org-ul"> <li>引用:  <a href="20221027T235104--kdoc-3-『ない仕事の作り方』__book.html#ID-20221027T235104">KDOC 3: 『ない仕事の作り方』</a>。から</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251214T193935--kdoc-506-圧倒的な量が集まってきたから好きになる__essay.html"/>
  <id>https://kijimad.github.io/roam/20251214T193935--kdoc-506-圧倒的な量が集まってきたから好きになる__essay.html</id>
  <updated>2025-12-22T17:09:52+09:00</updated>
</entry>
<entry>
  <title>KDOC 511: 半蔵門ミュージアムを観察する</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org6953910" class="outline-2">
 <h2 id="org6953910"> <a href="#org6953910">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org6953910">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul> <ul class="org-ul"> <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgbf8816a" class="outline-2">
 <h2 id="orgbf8816a"> <a href="#orgbf8816a">概要</a></h2>
 <div class="outline-text-2" id="text-orgbf8816a">
 <p>
半蔵門ミュージアムは、東京都千代田区にある歴史的な仏教美術品を展示する博物館である。
</p>

 <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d125215.87139745476!2d139.66005903906253!3d35.656440154172365!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60188c6556d00001%3A0xcd6709c1ea4ad3e1!2sHanzomon%20Museum!5e1!3m2!1sen!2sjp!4v1766207040753!5m2!1sen!2sjp" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
</div>
</div>
 <div id="outline-container-orgc27bad6" class="outline-2">
 <h2 id="orgc27bad6"> <a href="#orgc27bad6">メモ</a></h2>
 <div class="outline-text-2" id="text-orgc27bad6">
 <ul class="org-ul"> <li>全体的に広々していて、豪勢なつくりになっている。特に地下は天井の高さが3フロアぶんくらいあって地下と感じないほど広々としている。間接照明で砂岩ふうの壁が照らされている。非常に静かで、厳かな雰囲気がする</li>
 <li>面積の割に従業員が多い。受付に2人、エレベーターに1人、売店に2人、館内をスーツで巡回する人が数人いる。半蔵門という超絶スポットにある。それにも関わらず、入館料は無料である。明らかに公立の博物館よりコストがかかっているが、成り立っているのを不思議に感じた。宗教のバックグラウンドによるトリックがあるのだろうか</li>
 <li>紀元付近につくられたというインドの本物の石彫刻は、ケースにも入っていなくて、間近に観察できる。キラキラしたものを含む岩石に掘られている。ケースの有無は全然違う。服装や顔の感じはギリシャふうの雰囲気である</li>
</ul></div>
</div>
 <div id="outline-container-orga60259b" class="outline-2">
 <h2 id="orga60259b"> <a href="#orga60259b">感想</a></h2>
 <div class="outline-text-2" id="text-orga60259b">
 <ul class="org-ul"> <li>新興宗教を興す教祖になったつもりで見た。宗教グッズやストーリーにどういう「効果」があるかという観点で見る</li>
 <li>昔の人も現代人と変わらない認識で、当時の人になりきって想像する</li>
 <li>仏像は現代のフィギュアやアイドル文化みたいなもの。寺はテーマパークである</li>
 <li>まず仔細に実物を観察、考察して、それから解説を読んで楽しんだ。地下の解説は知らない登場人物が多すぎてわからなかったが、2階に易しい解説があった。わかりやすい</li>
 <li>平安時代の造物が(過去数度の補修があったとしても)残っているのがすごいと感じる</li>
 <li>仏教はグッズが多い感じがする。精巧で美しい、さまざまなタイプの仏像がある。恐ろしいもの、落ち着いたもの。こんな感じで等身大フィギュアに特色があれば、寺に行きたくなるのもわかる気がする</li>
 <li>神社にはあまりないように見える。お守りとか販売用の小物はあるが、神社によってわかりやすく違う造作はないように見える</li>
 <li>仏教は、壮大な原作とメディアミックス、同人誌の文化と解釈できるのではないか</li>
 <li>彫刻のなかには、粘土ならギリできそうなくらいの出来のものもあった。単品で成立するわけでなく石塔についていたレリーフのようであった。このクオリティがあることに少し安心した。歴史的逸品はあまりにうますぎて人がつくったものであることが信じられない</li>
 <li>今大人になって、時間をつくるのは大変であるが、当時の人たちも石の彫刻をほる時間をとるのは大変だっただろう。ヘタウマなところも含めて趣味の熱意を感じる</li>
</ul></div>
</div>
 <div id="outline-container-org248bdce" class="outline-2">
 <h2 id="org248bdce"> <a href="#org248bdce">関連</a></h2>
 <div class="outline-text-2" id="text-org248bdce">
 <ul class="org-ul"> <li>類推:  <a href="20241027T201315--kdoc-255-『完全教祖マニュアル』__book.html#ID-20241027T201315">KDOC 255: 『完全教祖マニュアル』</a>。教祖としての宗教を解説する</li>
</ul></div>
</div>
 <div id="outline-container-orge93f7c1" class="outline-2">
 <h2 id="orge93f7c1"> <a href="#orge93f7c1">Backlinks</a></h2>
 <div class="outline-text-2" id="text-orge93f7c1">
 <ul class="org-ul"> <li> <a href="./20240908T180537--kdoc-238-他人の博物館を観察して参考にする__project.html">KDOC 238: 他人の博物館を観察して参考にする</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251220T140427--kdoc-511-半蔵門ミュージアムを観察する__draft_essay.html"/>
  <id>https://kijimad.github.io/roam/20251220T140427--kdoc-511-半蔵門ミュージアムを観察する__draft_essay.html</id>
  <updated>2025-12-22T17:09:46+09:00</updated>
</entry>
<entry>
  <title>KDOC 500: Covering Indexを試す</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orgfa1d8a8" class="outline-2">
 <h2 id="orgfa1d8a8"> <a href="#orgfa1d8a8">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orgfa1d8a8">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org9d017b4" class="outline-2">
 <h2 id="org9d017b4"> <a href="#org9d017b4">概要</a></h2>
 <div class="outline-text-2" id="text-org9d017b4">
 <p>
 <a href="https://syu-m-5151.hatenablog.com/entry/2025/11/25/135220">「Postgres で試した？」と聞き返せるようになるまでもしくはなぜ私は雰囲気で技術を語るのか？</a>で、Covering Indexという見慣れない単語を見た。調べて、試す。
</p>

 <p>
インデックスにINCLUDEオプションをつけることで、内容についてもキャッシュを追加できる。
</p>

 <blockquote>
 <p>
オプションのINCLUDE句は非キー列としてインデックスに含める列のリストを指定します。 非キー列をインデックススキャンの検索条件に使うことはできません。また、インデックスで何であれ一意性制約や排他制約を強制する目的に対しても無視されます。 しかしながら、インデックスオンリースキャンは、インデックスエントリから値を直接得ることができるので、インデックスのテーブルを見に行く必要なく、非キー列の内容を返すことができます。 このように非キー列の追加は、そうでないとできないインデックスオンリースキャンを利用可能にします。
 <a href="https://www.postgresql.jp/docs/13/sql-createindex.html">CREATE INDEX</a>
</p>
</blockquote>

 <div class="org-src-container">
 <pre class="src src-sql"> <span class="org-keyword">CREATE</span>  <span class="org-keyword">TABLE</span>  <span class="org-function-name">users</span> (
    tel  <span class="org-type">integer</span>,
    name1  <span class="org-type">varchar</span>(255),
    name2  <span class="org-type">varchar</span>(255)
);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name1  <span class="org-keyword">ON</span> users(name1) INCLUDE (tel);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name2  <span class="org-keyword">ON</span> users(name2);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">include付き。Index Only Scan
</span>explain
 <span class="org-keyword">select</span> tel  <span class="org-keyword">from</span> users  <span class="org-keyword">where</span> name1 =  <span class="org-string">'a'</span>;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">includeなし。Index Scan
</span>explain
 <span class="org-keyword">select</span> tel  <span class="org-keyword">from</span> users  <span class="org-keyword">where</span> name2 =  <span class="org-string">'a'</span>;
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">|                                                                                  |
|----------------------------------------------------------------------------------|
| > CREATE TABLE users (                                                           |
| >     tel integer,                                                               |
| >     name1 varchar(255),                                                        |
| >     name2 varchar(255)                                                         |
| > );                                                                             |
| CREATE TABLE                                                                     |
|                                                                                  |
| > CREATE INDEX idx_users_name1 ON users(name1) INCLUDE (tel);                    |
| CREATE INDEX                                                                     |
|                                                                                  |
| > CREATE INDEX idx_users_name2 ON users(name2);                                  |
| CREATE INDEX                                                                     |
|                                                                                  |
| > explain                                                                        |
| > select tel from users where name1 = 'a';                                       |
| QUERY PLAN                                                                       |
| Index Only Scan using idx_users_name1 on users  (cost=0.14..8.16 rows=1 width=4) |
| Index Cond: (name1 = 'a'::text)                                                  |
|                                                                                  |
| > explain                                                                        |
| > select tel from users where name2 = 'a';                                       |
| QUERY PLAN                                                                       |
| Index Scan using idx_users_name2 on users  (cost=0.14..8.16 rows=1 width=4)      |
| Index Cond: ((name2)::text = 'a'::text)                                          |
</pre>
</div>
</div>
</div>
 <div id="outline-container-org6e6e6c8" class="outline-2">
 <h2 id="org6e6e6c8"> <a href="#org6e6e6c8">関連</a></h2>
 <div class="outline-text-2" id="text-org6e6e6c8">
 <ul class="org-ul"> <li>類推:  <a href="20251207T091742--kdoc-497-複合インデックスの使用条件を試す__permanent.html#ID-20251207T091742">KDOC 497: 複合インデックスの使用条件を試す</a>。同じくインデックスの話題</li>
 <li>具体例: どういったユースケースでCovering Indexを使うべきなのか</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251208T083954--kdoc-500-covering-indexを試す__permanent.html"/>
  <id>https://kijimad.github.io/roam/20251208T083954--kdoc-500-covering-indexを試す__permanent.html</id>
  <updated>2025-12-22T17:09:44+09:00</updated>
</entry>
<entry>
  <title>KDOC 503: Linuxカーネルは/boot配下にあるvmlinuzファイルである</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org9f334be" class="outline-2">
 <h2 id="org9f334be"> <a href="#org9f334be">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org9f334be">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org75b64a7" class="outline-2">
 <h2 id="org75b64a7"> <a href="#org75b64a7">概要</a></h2>
 <div class="outline-text-2" id="text-org75b64a7">
 <p>
Linuxカーネルは  <code>/boot</code> 配下にある  <code>vmlinuz</code> ファイルである、といえる。カーネルは  <code>gzip</code> で圧縮されているので  <code>z</code> がついている。
</p>

 <p>
手元の環境で試してみると確かに  <code>vmlinuz</code> が存在する。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>確かめる</label> <pre class="src src-shell">ls /boot -al
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">total 95208
drwxr-xr-x  4 root root     4096 Feb 11  2025 .
drwxr-xr-x 24 root root     4096 Oct  5 22:04 ..
-rw-r--r--  1 root root   287413 Dec  1  2024 config-6.8.0-51-generic
drwx------  3 root root     4096 Jan  1  1970 efi
drwxr-xr-x  5 root root     4096 Feb 11  2025 grub
lrwxrwxrwx  1 root root       27 Feb 11  2025 initrd.img -> initrd.img-6.8.0-51-generic
-rw-r--r--  1 root root 73134942 Feb 11  2025 initrd.img-6.8.0-51-generic
lrwxrwxrwx  1 root root       27 Feb 11  2025 initrd.img.old -> initrd.img-6.8.0-51-generic
-rw-------  1 root root  9072978 Dec  1  2024 System.map-6.8.0-51-generic
lrwxrwxrwx  1 root root       24 Feb 11  2025 vmlinuz -> vmlinuz-6.8.0-51-generic
-rw-r--r--  1 root root 14969224 Dec  1  2024 vmlinuz-6.8.0-51-generic
</pre>
</div>
</div>
</div>
 <div id="outline-container-org34bf4d7" class="outline-2">
 <h2 id="org34bf4d7"> <a href="#org34bf4d7">関連</a></h2>
 <div class="outline-text-2" id="text-org34bf4d7">
 <ul class="org-ul"> <li>引用:  <a href="20240105T215847--kdoc-63-『私はどのようにしてlinuxカーネルを学んだか』__book.html#ID-20240105T215847">KDOC 63: 『私はどのようにしてLinuxカーネルを学んだか』</a>から。端的にどこにあたるかが示されていて面白いと感じた</li>
 <li>追加調査:  <code>/boot</code> ディレクトリのほかのファイルが何か見る</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251212T232903--kdoc-503-linuxカーネルはboot配下にあるvmlinuzファイルである__permanent.html"/>
  <id>https://kijimad.github.io/roam/20251212T232903--kdoc-503-linuxカーネルはboot配下にあるvmlinuzファイルである__permanent.html</id>
  <updated>2025-12-22T17:09:40+09:00</updated>
</entry>
<entry>
  <title>KDOC 497: 複合インデックスの使用条件を試す</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org7af83ac" class="outline-2">
 <h2 id="org7af83ac"> <a href="#org7af83ac">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org7af83ac">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-15 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-15 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgaaa8eed" class="outline-2">
 <h2 id="orgaaa8eed"> <a href="#orgaaa8eed">概要</a></h2>
 <div class="outline-text-2" id="text-orgaaa8eed">
 <p>
複合インデックスによるスキャン方法の変化を実験した。
</p>

 <div class="org-src-container">
 <label class="org-src-name"> <span class="listing-number">Listing 1: </span>複合インデックスを使う</label> <pre class="src src-sql"> <span class="org-keyword">CREATE</span>  <span class="org-keyword">TABLE</span>  <span class="org-function-name">users</span> (
    id serial  <span class="org-keyword">PRIMARY</span>  <span class="org-keyword">KEY</span>,
     <span class="org-keyword">name</span>  <span class="org-type">varchar</span>(255),
    tel  <span class="org-type">integer</span>,
    nonidx  <span class="org-type">varchar</span>(255)
);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name  <span class="org-keyword">ON</span> users( <span class="org-keyword">name</span>, tel);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">レコードが空だと、すべてIndex Onlyになったため
</span> <span class="org-keyword">INSERT</span>  <span class="org-keyword">INTO</span> users ( <span class="org-keyword">name</span>, tel)
 <span class="org-keyword">SELECT</span>
     <span class="org-string">'Name'</span> || (i % 1000),
    (i % 10000)
 <span class="org-keyword">FROM</span> generate_series(1, 100000) i;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">複合インデックスの両方の要素を使うと、インデックスが使われる
</span>explain
 <span class="org-keyword">select</span> id  <span class="org-keyword">from</span> users  <span class="org-keyword">where</span>  <span class="org-keyword">name</span> =  <span class="org-string">'a'</span>  <span class="org-keyword">and</span> tel = 1;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">複合インデックスの両方の要素を使ってインデックス要素だけだと、Index Only Scanになる
</span>explain
 <span class="org-keyword">select</span>  <span class="org-keyword">name</span>  <span class="org-keyword">from</span> users  <span class="org-keyword">where</span>  <span class="org-keyword">name</span> =  <span class="org-string">'a'</span>  <span class="org-keyword">and</span> tel = 1;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">複合インデックスの最初の要素を使うと、インデックスが使われる
</span>explain
 <span class="org-keyword">select</span> id  <span class="org-keyword">from</span> users  <span class="org-keyword">where</span>  <span class="org-keyword">name</span> =  <span class="org-string">'a'</span>;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">複合インデックスの順番も入れ替えても、要素があっていればインデックスが使われる
</span>explain
 <span class="org-keyword">select</span> id  <span class="org-keyword">from</span> users  <span class="org-keyword">where</span> tel = 1  <span class="org-keyword">and</span>  <span class="org-keyword">name</span> =  <span class="org-string">'a'</span>;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">複合インデックスの最初の要素 + インデックス外だとインデックスが使われる
</span>explain
 <span class="org-keyword">select</span> id  <span class="org-keyword">from</span> users  <span class="org-keyword">where</span>  <span class="org-keyword">name</span> =  <span class="org-string">'a'</span>  <span class="org-keyword">and</span> nonidx =  <span class="org-string">'a'</span>;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">複合インデックスの2番めの要素を使うと、インデックスが使われない
</span>explain
 <span class="org-keyword">select</span> id  <span class="org-keyword">from</span> users  <span class="org-keyword">where</span> tel = 1;
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">|                                                                                   |   |             |
|-----------------------------------------------------------------------------------+---+-------------|
| > CREATE TABLE users (                                                            |   |             |
| >     id serial PRIMARY KEY,                                                      |   |             |
| >     name varchar(255),                                                          |   |             |
| >     tel integer,                                                                |   |             |
| >     nonidx varchar(255)                                                         |   |             |
| > );                                                                              |   |             |
| CREATE TABLE                                                                      |   |             |
|                                                                                   |   |             |
| > CREATE INDEX idx_users_name ON users(name, tel);                                |   |             |
| CREATE INDEX                                                                      |   |             |
|                                                                                   |   |             |
| > INSERT INTO users (name, tel)                                                   |   |             |
| > SELECT                                                                          |   |             |
| >     'Name'                                                                      |   | (i % 1000), |
| >     (i % 10000)                                                                 |   |             |
| > FROM generate_series(1, 100000) i;                                              |   |             |
| INSERT 0 100000                                                                   |   |             |
|                                                                                   |   |             |
| > explain                                                                         |   |             |
| > select id from users where name = 'a' and tel = 1;                              |   |             |
| QUERY PLAN                                                                        |   |             |
| Index Scan using idx_users_name on users  (cost=0.28..8.30 rows=1 width=4)        |   |             |
| Index Cond: (((name)::text = 'a'::text) AND (tel = 1))                            |   |             |
|                                                                                   |   |             |
| > explain                                                                         |   |             |
| > select name from users where name = 'a' and tel = 1;                            |   |             |
| QUERY PLAN                                                                        |   |             |
| Index Only Scan using idx_users_name on users  (cost=0.28..8.30 rows=1 width=516) |   |             |
| Index Cond: ((name = 'a'::text) AND (tel = 1))                                    |   |             |
|                                                                                   |   |             |
| > explain                                                                         |   |             |
| > select id from users where name = 'a';                                          |   |             |
| QUERY PLAN                                                                        |   |             |
| Bitmap Heap Scan on users  (cost=4.43..69.98 rows=19 width=4)                     |   |             |
| Recheck Cond: ((name)::text = 'a'::text)                                          |   |             |
| ->  Bitmap Index Scan on idx_users_name  (cost=0.00..4.42 rows=19 width=0)        |   |             |
| Index Cond: ((name)::text = 'a'::text)                                            |   |             |
|                                                                                   |   |             |
| > explain                                                                         |   |             |
| > select id from users where tel = 1 and name = 'a';                              |   |             |
| QUERY PLAN                                                                        |   |             |
| Index Scan using idx_users_name on users  (cost=0.28..8.30 rows=1 width=4)        |   |             |
| Index Cond: (((name)::text = 'a'::text) AND (tel = 1))                            |   |             |
|                                                                                   |   |             |
| > explain                                                                         |   |             |
| > select id from users where name = 'a' and nonidx = 'a';                         |   |             |
| QUERY PLAN                                                                        |   |             |
| Bitmap Heap Scan on users  (cost=4.42..70.03 rows=1 width=4)                      |   |             |
| Recheck Cond: ((name)::text = 'a'::text)                                          |   |             |
| Filter: ((nonidx)::text = 'a'::text)                                              |   |             |
| ->  Bitmap Index Scan on idx_users_name  (cost=0.00..4.42 rows=19 width=0)        |   |             |
| Index Cond: ((name)::text = 'a'::text)                                            |   |             |
|                                                                                   |   |             |
| > explain                                                                         |   |             |
| > select id from users where tel = 1;                                             |   |             |
| QUERY PLAN                                                                        |   |             |
| Seq Scan on users  (cost=0.00..588.34 rows=19 width=4)                            |   |             |
| Filter: (tel = 1)                                                                 |   |             |
</pre>
</div>

 <p>
さまざまなスキャン方法があるのを知るのだった。
</p>

 <ul class="org-ul"> <li>Seq Scan</li>
 <li>Bitmap Index Scan</li>
 <li>Bitmap Heap Scan</li>
 <li>Index Only Scan</li>
</ul></div>
</div>
 <div id="outline-container-orgd4a9999" class="outline-2">
 <h2 id="orgd4a9999"> <a href="#orgd4a9999">関連</a></h2>
 <div class="outline-text-2" id="text-orgd4a9999">
 <ul class="org-ul"> <li>動機:  <a href="20251206T213844--kdoc-496-index-only-scanの様子を見る__permanent.html#ID-20251206T213844">KDOC 496: Index (Only) Scanの様子を見る</a>。インデックスを確かめているときに考えた</li>
 <li>追加調査: 複数のスキャン方法を試す</li>
 <li>疑問: 複合でないインデックスはなんというのか</li>
 <li>疑問: 似たインデックスが複数ある場合にどのように選ばれるか</li>
 <li>疑問: 複合インデックスは技術的にどうなっているのか</li>
</ul></div>
</div>
 <div id="outline-container-org2d6d30b" class="outline-2">
 <h2 id="org2d6d30b"> <a href="#org2d6d30b">Backlinks</a></h2>
 <div class="outline-text-2" id="text-org2d6d30b">
 <ul class="org-ul"> <li> <a href="./20251208T083954--kdoc-500-covering-indexを試す__permanent.html">KDOC 500: Covering Indexを試す</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251207T091742--kdoc-497-複合インデックスの使用条件を試す__permanent.html"/>
  <id>https://kijimad.github.io/roam/20251207T091742--kdoc-497-複合インデックスの使用条件を試す__permanent.html</id>
  <updated>2025-12-22T17:09:38+09:00</updated>
</entry>
<entry>
  <title>KDOC 514: ARPテーブルとMACアドレステーブルの違い</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orge0e8be6" class="outline-2">
 <h2 id="orge0e8be6"> <a href="#orge0e8be6">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orge0e8be6">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul> <ul class="org-ul"> <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgdd7f2bb" class="outline-2">
 <h2 id="orgdd7f2bb"> <a href="#orgdd7f2bb">概要</a></h2>
 <div class="outline-text-2" id="text-orgdd7f2bb">
 <p>
ARPテーブルとMACアドレステーブルの違い。
</p>

 <ul class="org-ul"> <li>ARPテーブル: IP と MAC … 各NICデバイスごとで持つ</li>
 <li>MACアドレステーブル: MACとポート … ポート番号を引く用, ブリッジが持つ</li>
</ul></div>
</div>
 <div id="outline-container-org88fd9d4" class="outline-2">
 <h2 id="org88fd9d4"> <a href="#org88fd9d4">関連</a></h2>
 <div class="outline-text-2" id="text-org88fd9d4">
 <ul class="org-ul"> <li>動機:  <a href="20251023T173743--kdoc-477-『docker-kubernetesネットワークのしくみ』__book.html#ID-20251023T173743">KDOC 477: 『Docker-Kubernetesネットワークのしくみ』</a>を読んでいて疑問に感じて調べた</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251221T092231--kdoc-514-arpテーブルとmacアドレステーブルの違い__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20251221T092231--kdoc-514-arpテーブルとmacアドレステーブルの違い__draft_permanent.html</id>
  <updated>2025-12-22T17:09:37+09:00</updated>
</entry>
<entry>
  <title>KDOC 508: 除算の実行速度を計測する</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org6624686" class="outline-2">
 <h2 id="org6624686"> <a href="#org6624686">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org6624686">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul> <ul class="org-ul"> <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgce6789a" class="outline-2">
 <h2 id="orgce6789a"> <a href="#orgce6789a">概要</a></h2>
 <div class="outline-text-2" id="text-orgce6789a">
 <p>
除算というのは負荷の大きな演算であり、加算などの演算に比べると、実行に要する時間がはるかに長い(p51)。
</p>

 <p>
305の方法で計測する。
</p>
</div>
</div>
 <div id="outline-container-org0f7d842" class="outline-2">
 <h2 id="org0f7d842"> <a href="#org0f7d842">関連</a></h2>
 <div class="outline-text-2" id="text-org0f7d842">
 <ul class="org-ul"> <li>参照:  <a href="20240810T122445--kdoc-217-『基礎からきっちり覚える-機械語入門』__book.html#ID-20240810T122445">KDOC 217: 『基礎からきっちり覚える 機械語入門』</a>から</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251218T232745--kdoc-508-除算の実行速度を計測する__draft_permanent.html"/>
  <id>https://kijimad.github.io/roam/20251218T232745--kdoc-508-除算の実行速度を計測する__draft_permanent.html</id>
  <updated>2025-12-22T17:09:37+09:00</updated>
</entry>
<entry>
  <title>KDOC 501: インデックスのオーバーヘッドを検証する</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org29c3b07" class="outline-2">
 <h2 id="org29c3b07"> <a href="#org29c3b07">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org29c3b07">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-16 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org2585988" class="outline-2">
 <h2 id="org2585988"> <a href="#org2585988">概要</a></h2>
 <div class="outline-text-2" id="text-org2585988">
 <p>
 <a href="https://syu-m-5151.hatenablog.com/entry/2025/11/25/135220">「Postgres で試した？」と聞き返せるようになるまでもしくはなぜ私は雰囲気で技術を語るのか？ — Just use Postgres 読書感想文</a>のOver-Indexingを読んで、インデックスの具体的なオーバヘッドを知った。
</p>

 <blockquote>
 <ul class="org-ul"> <li>作成時にディスク容量を消費する</li>
 <li>更新時にメンテナンスコストがかかる</li>
 <li>計画時（Planning Time）にオプション評価のコストがかかる</li>
</ul></blockquote>

 <p>
これらをじっさいに試す。
</p>
</div>
 <div id="outline-container-org21b6e3b" class="outline-3">
 <h3 id="org21b6e3b"> <a href="#org21b6e3b">作成時のディスク容量</a></h3>
 <div class="outline-text-3" id="text-org21b6e3b">
 <p>
レコードを作成して、インデックスのディスク容量を見る。
</p>

 <div class="org-src-container">
 <pre class="src src-sql"> <span class="org-keyword">CREATE</span>  <span class="org-keyword">TABLE</span>  <span class="org-function-name">users</span> (
     <span class="org-keyword">name</span>  <span class="org-type">varchar</span>(255)
);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">インデックスを追加する
</span> <span class="org-keyword">CREATE</span> INDEX idx_users_name  <span class="org-keyword">ON</span> users( <span class="org-keyword">name</span>);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">レコード挿入する
</span> <span class="org-keyword">INSERT</span>  <span class="org-keyword">INTO</span> users ( <span class="org-keyword">name</span>)
 <span class="org-keyword">SELECT</span>
      <span class="org-comment-delimiter">-- </span> <span class="org-comment">32x2 文字
</span>     md5(random()::text) || md5(random()::text)
 <span class="org-keyword">FROM</span> generate_series(1, 100000) i;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">レコード数を確認する
</span> <span class="org-keyword">select</span>  <span class="org-builtin">count</span>(*)  <span class="org-keyword">from</span> users;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">インデックスサイズを確認する
</span> <span class="org-keyword">SELECT</span> pg_size_pretty(pg_relation_size( <span class="org-string">'idx_users_name'</span>));
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">|                                                              |   |                     |
|--------------------------------------------------------------+---+---------------------|
| > CREATE TABLE users (                                       |   |                     |
| >     name varchar(255)                                      |   |                     |
| > );                                                         |   |                     |
| CREATE TABLE                                                 |   |                     |
|                                                              |   |                     |
| > CREATE INDEX idx_users_name ON users(name);                |   |                     |
| CREATE INDEX                                                 |   |                     |
|                                                              |   |                     |
| > BEGIN;                                                     |   |                     |
| BEGIN                                                        |   |                     |
|                                                              |   |                     |
| > INSERT INTO users (name)                                   |   |                     |
| > SELECT                                                     |   |                     |
| >      -- 32x2 文字                                          |   |                     |
| >      md5(random()::text)                                   |   | md5(random()::text) |
| > FROM generate_series(1, 100000) i;                         |   |                     |
| INSERT 0 100000                                              |   |                     |
|                                                              |   |                     |
| > ROLLBACK;                                                  |   |                     |
| ROLLBACK                                                     |   |                     |
|                                                              |   |                     |
| > select count(*) from users;                                |   |                     |
| count                                                        |   |                     |
| 0                                                            |   |                     |
|                                                              |   |                     |
| > SELECT pg_size_pretty(pg_relation_size('idx_users_name')); |   |                     |
| pg_size_pretty                                               |   |                     |
| 12 MB                                                        |   |                     |
</pre>
</div>

 <p>
10万レコード、1レコード64バイトで、インデックスサイズは12MBある。
</p>
</div>
</div>
 <div id="outline-container-org7a191e9" class="outline-3">
 <h3 id="org7a191e9"> <a href="#org7a191e9">更新時のコスト</a></h3>
 <div class="outline-text-3" id="text-org7a191e9">
 <p>
インデックスの有無を変えてレコードを更新したときの時間を見る。
</p>

 <div class="org-src-container">
 <pre class="src src-sql"> <span class="org-keyword">CREATE</span>  <span class="org-keyword">TABLE</span>  <span class="org-function-name">users</span> (
     <span class="org-keyword">name</span>  <span class="org-type">varchar</span>(255)
);

EXPLAIN ANALYZE
 <span class="org-keyword">INSERT</span>  <span class="org-keyword">INTO</span> users ( <span class="org-keyword">name</span>)
 <span class="org-keyword">SELECT</span>
      <span class="org-comment-delimiter">-- </span> <span class="org-comment">32x2 文字
</span>     md5(random()::text) || md5(random()::text)
 <span class="org-keyword">FROM</span> generate_series(1, 100000) i;

EXPLAIN ANALYZE
 <span class="org-keyword">UPDATE</span> users  <span class="org-keyword">SET</span>  <span class="org-keyword">name</span> =  <span class="org-string">'abc'</span>;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">インデックスを追加する
</span> <span class="org-keyword">CREATE</span> INDEX idx_users_name  <span class="org-keyword">ON</span> users( <span class="org-keyword">name</span>);

EXPLAIN ANALYZE
 <span class="org-keyword">UPDATE</span> users  <span class="org-keyword">SET</span>  <span class="org-keyword">name</span> =  <span class="org-string">'def'</span>;
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">|                                                                                                                                      |   |                     |
|--------------------------------------------------------------------------------------------------------------------------------------+---+---------------------|
| > CREATE TABLE users (                                                                                                               |   |                     |
| >     name varchar(255)                                                                                                              |   |                     |
| > );                                                                                                                                 |   |                     |
| CREATE TABLE                                                                                                                         |   |                     |
|                                                                                                                                      |   |                     |
| > EXPLAIN ANALYZE                                                                                                                    |   |                     |
| > INSERT INTO users (name)                                                                                                           |   |                     |
| > SELECT                                                                                                                             |   |                     |
| >      -- 32x2 文字                                                                                                                  |   |                     |
| >      md5(random()::text)                                                                                                           |   | md5(random()::text) |
| > FROM generate_series(1, 100000) i;                                                                                                 |   |                     |
| QUERY PLAN                                                                                                                           |   |                     |
| Insert on users  (cost=0.00..3500.00 rows=0 width=0) (actual time=127.862..127.863 rows=0.00 loops=1)                                |   |                     |
| Buffers: shared hit=102466 dirtied=1236 written=1238                                                                                 |   |                     |
| ->  Subquery Scan on "*SELECT*"  (cost=0.00..3500.00 rows=100000 width=516) (actual time=2.628..92.992 rows=100000.00 loops=1)         |   |                     |
| ->  Function Scan on generate_series i  (cost=0.00..3250.00 rows=100000 width=32) (actual time=2.627..88.029 rows=100000.00 loops=1) |   |                     |
| Planning:                                                                                                                            |   |                     |
| Buffers: shared hit=6                                                                                                                |   |                     |
| Planning Time: 0.033 ms                                                                                                              |   |                     |
| Execution Time: 128.000 ms                                                                                                           |   |                     |
|                                                                                                                                      |   |                     |
| > EXPLAIN ANALYZE                                                                                                                    |   |                     |
| > UPDATE users SET name = 'abc';                                                                                                     |   |                     |
| QUERY PLAN                                                                                                                           |   |                     |
| Update on users  (cost=0.00..1420.25 rows=0 width=0) (actual time=64.452..64.452 rows=0.00 loops=1)                                  |   |                     |
| Buffers: shared hit=304574 dirtied=437 written=437                                                                                   |   |                     |
| ->  Seq Scan on users  (cost=0.00..1420.25 rows=18525 width=522) (actual time=0.007..5.503 rows=100000.00 loops=1)                   |   |                     |
| Buffers: shared hit=1235                                                                                                             |   |                     |
| Planning:                                                                                                                            |   |                     |
| Buffers: shared hit=22                                                                                                               |   |                     |
| Planning Time: 0.112 ms                                                                                                              |   |                     |
| Execution Time: 64.506 ms                                                                                                            |   |                     |
|                                                                                                                                      |   |                     |
| > CREATE INDEX idx_users_name ON users(name);                                                                                        |   |                     |
| CREATE INDEX                                                                                                                         |   |                     |
|                                                                                                                                      |   |                     |
| > EXPLAIN ANALYZE                                                                                                                    |   |                     |
| > UPDATE users SET name = 'def';                                                                                                     |   |                     |
| QUERY PLAN                                                                                                                           |   |                     |
| Update on users  (cost=0.00..2672.00 rows=0 width=0) (actual time=119.053..119.053 rows=0.00 loops=1)                                |   |                     |
| Buffers: shared hit=501291 read=2 dirtied=518 written=516                                                                            |   |                     |
| ->  Seq Scan on users  (cost=0.00..2672.00 rows=100000 width=522) (actual time=0.008..6.486 rows=100000.00 loops=1)                  |   |                     |
| Buffers: shared hit=1672                                                                                                             |   |                     |
| Planning:                                                                                                                            |   |                     |
| Buffers: shared hit=15 read=1                                                                                                        |   |                     |
| Planning Time: 0.074 ms                                                                                                              |   |                     |
| Execution Time: 119.072 ms                                                                                                           |   |                     |
</pre>
</div>

 <ul class="org-ul"> <li>インデックスなしフィールドの更新(10万件)
 <ul class="org-ul"> <li>Planning Time: 0.112 ms</li>
 <li>Execution Time: 64.506 ms</li>
</ul></li>
 <li>インデックスありフィールドの更新(10万件)
 <ul class="org-ul"> <li>Planning Time: 0.074 ms</li>
 <li>Execution Time: 119.072 ms</li>
</ul></li>
</ul> <p>
インデックスがあると更新の計画時間は減ったが、実行時間が増加している。
</p>
</div>
</div>
 <div id="outline-container-orgda851f1" class="outline-3">
 <h3 id="orgda851f1"> <a href="#orgda851f1">計画時間のコスト</a></h3>
 <div class="outline-text-3" id="text-orgda851f1">
 <div class="org-src-container">
 <pre class="src src-sql"> <span class="org-keyword">CREATE</span>  <span class="org-keyword">TABLE</span>  <span class="org-function-name">users</span> (
     <span class="org-keyword">name</span>  <span class="org-type">varchar</span>(255)
);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">レコード挿入する
</span> <span class="org-keyword">INSERT</span>  <span class="org-keyword">INTO</span> users ( <span class="org-keyword">name</span>)
 <span class="org-keyword">SELECT</span>
      <span class="org-comment-delimiter">-- </span> <span class="org-comment">32x2 文字
</span>     md5(random()::text) || md5(random()::text)
 <span class="org-keyword">FROM</span> generate_series(1, 100000) i;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">レコード数を確認する
</span> <span class="org-keyword">select</span>  <span class="org-builtin">count</span>(*)  <span class="org-keyword">from</span> users;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">計画の詳細を出す
</span>EXPLAIN (ANALYZE, VERBOSE, COSTS, TIMING)
 <span class="org-keyword">SELECT</span> *  <span class="org-keyword">FROM</span> users  <span class="org-keyword">WHERE</span>  <span class="org-keyword">name</span> =  <span class="org-string">'NO_INDEX'</span>;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">インデックスを追加する
</span> <span class="org-keyword">CREATE</span> INDEX idx_users_name  <span class="org-keyword">ON</span> users( <span class="org-keyword">name</span>);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">計画の詳細を出す
</span>EXPLAIN (ANALYZE, VERBOSE, COSTS, TIMING)
 <span class="org-keyword">SELECT</span> *  <span class="org-keyword">FROM</span> users  <span class="org-keyword">WHERE</span>  <span class="org-keyword">name</span> =  <span class="org-string">'WITH_INDEX'</span>;
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">|                                                                                                                           |   |                     |
|---------------------------------------------------------------------------------------------------------------------------+---+---------------------|
| > CREATE TABLE users (                                                                                                    |   |                     |
| >     name varchar(255)                                                                                                   |   |                     |
| > );                                                                                                                      |   |                     |
| CREATE TABLE                                                                                                              |   |                     |
|                                                                                                                           |   |                     |
| > INSERT INTO users (name)                                                                                                |   |                     |
| > SELECT                                                                                                                  |   |                     |
| >      -- 32x2 文字                                                                                                       |   |                     |
| >      md5(random()::text)                                                                                                |   | md5(random()::text) |
| > FROM generate_series(1, 100000) i;                                                                                      |   |                     |
| INSERT 0 100000                                                                                                           |   |                     |
|                                                                                                                           |   |                     |
| > select count(*) from users;                                                                                             |   |                     |
| count                                                                                                                     |   |                     |
| 100000                                                                                                                    |   |                     |
|                                                                                                                           |   |                     |
| > EXPLAIN (ANALYZE, VERBOSE, COSTS, TIMING)                                                                               |   |                     |
| > SELECT * FROM users WHERE name = 'NO_INDEX';                                                                            |   |                     |
| QUERY PLAN                                                                                                                |   |                     |
| Seq Scan on public.users  (cost=0.00..1466.56 rows=93 width=516) (actual time=2.421..2.421 rows=0.00 loops=1)             |   |                     |
| Output: name                                                                                                              |   |                     |
| Filter: ((users.name)::text = 'NO_INDEX'::text)                                                                           |   |                     |
| Rows Removed by Filter: 100000                                                                                            |   |                     |
| Buffers: shared hit=1235                                                                                                  |   |                     |
| Planning:                                                                                                                 |   |                     |
| Buffers: shared hit=9                                                                                                     |   |                     |
| Planning Time: 0.038 ms                                                                                                   |   |                     |
| Execution Time: 2.426 ms                                                                                                  |   |                     |
|                                                                                                                           |   |                     |
| > CREATE INDEX idx_users_name ON users(name);                                                                             |   |                     |
| CREATE INDEX                                                                                                              |   |                     |
|                                                                                                                           |   |                     |
| > EXPLAIN (ANALYZE, VERBOSE, COSTS, TIMING)                                                                               |   |                     |
| > SELECT * FROM users WHERE name = 'WITH_INDEX';                                                                          |   |                     |
| QUERY PLAN                                                                                                                |   |                     |
| Bitmap Heap Scan on public.users  (cost=28.29..974.23 rows=500 width=516) (actual time=0.014..0.015 rows=0.00 loops=1)    |   |                     |
| Output: name                                                                                                              |   |                     |
| Recheck Cond: ((users.name)::text = 'WITH_INDEX'::text)                                                                   |   |                     |
| Buffers: shared read=3                                                                                                    |   |                     |
| ->  Bitmap Index Scan on idx_users_name  (cost=0.00..28.17 rows=500 width=0) (actual time=0.011..0.011 rows=0.00 loops=1) |   |                     |
| Index Cond: ((users.name)::text = 'WITH_INDEX'::text)                                                                     |   |                     |
| Index Searches: 1                                                                                                         |   |                     |
| Buffers: shared read=3                                                                                                    |   |                     |
| Planning:                                                                                                                 |   |                     |
| Buffers: shared hit=15 read=1                                                                                             |   |                     |
| Planning Time: 0.104 ms                                                                                                   |   |                     |
| Execution Time: 0.021 ms                                                                                                  |   |                     |
</pre>
</div>

 <ul class="org-ul"> <li>Planning Time: 0.038 ms -> 0.104 ms</li>
 <li>Execution Time: 2.426 ms -> 0.021 ms</li>
</ul> <p>
実行時間は激減したが、計画時間は増えた。この例では明らかにメリットのほうが大きいが、インデックスが増えて選択肢が増えると悪化していくのだろう。
</p>
</div>
</div>
 <div id="outline-container-orgdec1290" class="outline-3">
 <h3 id="orgdec1290"> <a href="#orgdec1290">大量インデックスの計画コスト</a></h3>
 <div class="outline-text-3" id="text-orgdec1290">
 <p>
インデックス増加による計画時間の増加を見る。
</p>

 <div class="org-src-container">
 <pre class="src src-sql"> <span class="org-keyword">CREATE</span>  <span class="org-keyword">TABLE</span>  <span class="org-function-name">users</span> (
    noindex  <span class="org-type">varchar</span>(255),
    name1  <span class="org-type">varchar</span>(255),
    name2  <span class="org-type">varchar</span>(255),
    name3  <span class="org-type">varchar</span>(255),
    name4  <span class="org-type">varchar</span>(255),
    name5  <span class="org-type">varchar</span>(255),
    name6  <span class="org-type">varchar</span>(255),
    name7  <span class="org-type">varchar</span>(255),
    name8  <span class="org-type">varchar</span>(255),
    name9  <span class="org-type">varchar</span>(255),
    name10  <span class="org-type">varchar</span>(255),
    name11  <span class="org-type">varchar</span>(255),
    name12  <span class="org-type">varchar</span>(255),
    name13  <span class="org-type">varchar</span>(255),
    name14  <span class="org-type">varchar</span>(255),
    name15  <span class="org-type">varchar</span>(255),
    name16  <span class="org-type">varchar</span>(255),
    name17  <span class="org-type">varchar</span>(255),
    name18  <span class="org-type">varchar</span>(255),
    name19  <span class="org-type">varchar</span>(255),
    name20  <span class="org-type">varchar</span>(255)
);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">レコード挿入する
</span> <span class="org-keyword">INSERT</span>  <span class="org-keyword">INTO</span> users (name1)
 <span class="org-keyword">SELECT</span>
      <span class="org-comment-delimiter">-- </span> <span class="org-comment">32x2 文字
</span>     md5(random()::text) || md5(random()::text)
 <span class="org-keyword">FROM</span> generate_series(1, 100000) i;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">インデックスを追加する
</span> <span class="org-keyword">CREATE</span> INDEX idx_users_name1  <span class="org-keyword">ON</span> users(name1);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name2  <span class="org-keyword">ON</span> users(name2);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name3  <span class="org-keyword">ON</span> users(name3);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name4  <span class="org-keyword">ON</span> users(name4);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name5  <span class="org-keyword">ON</span> users(name5);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name6  <span class="org-keyword">ON</span> users(name6);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name7  <span class="org-keyword">ON</span> users(name7);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name8  <span class="org-keyword">ON</span> users(name8);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name9  <span class="org-keyword">ON</span> users(name9);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name10  <span class="org-keyword">ON</span> users(name10);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name11  <span class="org-keyword">ON</span> users(name11);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name12  <span class="org-keyword">ON</span> users(name12);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name13  <span class="org-keyword">ON</span> users(name13);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name14  <span class="org-keyword">ON</span> users(name14);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name15  <span class="org-keyword">ON</span> users(name15);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name16  <span class="org-keyword">ON</span> users(name16);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name17  <span class="org-keyword">ON</span> users(name17);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name18  <span class="org-keyword">ON</span> users(name18);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name19  <span class="org-keyword">ON</span> users(name19);
 <span class="org-keyword">CREATE</span> INDEX idx_users_name20  <span class="org-keyword">ON</span> users(name20);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">インデックスがないものを検索する
</span>EXPLAIN (ANALYZE)
 <span class="org-keyword">SELECT</span> noindex  <span class="org-keyword">FROM</span> users  <span class="org-keyword">WHERE</span> noindex =  <span class="org-string">'xx'</span>;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">インデックスがあるものを検索する
</span>EXPLAIN (ANALYZE)
 <span class="org-keyword">SELECT</span> name1  <span class="org-keyword">FROM</span> users  <span class="org-keyword">WHERE</span> name1 =  <span class="org-string">'xx'</span>;
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">|                                                                                                                            |   |                     |
|----------------------------------------------------------------------------------------------------------------------------+---+---------------------|
| > CREATE TABLE users (                                                                                                     |   |                     |
| >     noindex varchar(255),                                                                                                |   |                     |
| >     name1 varchar(255),                                                                                                  |   |                     |
| >     name2 varchar(255),                                                                                                  |   |                     |
| >     name3 varchar(255),                                                                                                  |   |                     |
| >     name4 varchar(255),                                                                                                  |   |                     |
| >     name5 varchar(255),                                                                                                  |   |                     |
| >     name6 varchar(255),                                                                                                  |   |                     |
| >     name7 varchar(255),                                                                                                  |   |                     |
| >     name8 varchar(255),                                                                                                  |   |                     |
| >     name9 varchar(255),                                                                                                  |   |                     |
| >     name10 varchar(255),                                                                                                 |   |                     |
| >     name11 varchar(255),                                                                                                 |   |                     |
| >     name12 varchar(255),                                                                                                 |   |                     |
| >     name13 varchar(255),                                                                                                 |   |                     |
| >     name14 varchar(255),                                                                                                 |   |                     |
| >     name15 varchar(255),                                                                                                 |   |                     |
| >     name16 varchar(255),                                                                                                 |   |                     |
| >     name17 varchar(255),                                                                                                 |   |                     |
| >     name18 varchar(255),                                                                                                 |   |                     |
| >     name19 varchar(255),                                                                                                 |   |                     |
| >     name20 varchar(255)                                                                                                  |   |                     |
| > );                                                                                                                       |   |                     |
| CREATE TABLE                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > INSERT INTO users (name1)                                                                                                |   |                     |
| > SELECT                                                                                                                   |   |                     |
| >      -- 32x2 文字                                                                                                        |   |                     |
| >      md5(random()::text)                                                                                                 |   | md5(random()::text) |
| > FROM generate_series(1, 100000) i;                                                                                       |   |                     |
| INSERT 0 100000                                                                                                            |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name1 ON users(name1);                                                                            |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name1_2 ON users(name1, name2);                                                                   |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name2 ON users(name2);                                                                            |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name3 ON users(name3);                                                                            |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name4 ON users(name4);                                                                            |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name5 ON users(name5);                                                                            |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name6 ON users(name6);                                                                            |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name7 ON users(name7);                                                                            |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name8 ON users(name8);                                                                            |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name9 ON users(name9);                                                                            |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name10 ON users(name10);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name11 ON users(name11);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name12 ON users(name12);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name13 ON users(name13);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name14 ON users(name14);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name15 ON users(name15);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name16 ON users(name16);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name17 ON users(name17);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name18 ON users(name18);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name19 ON users(name19);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > CREATE INDEX idx_users_name20 ON users(name20);                                                                          |   |                     |
| CREATE INDEX                                                                                                               |   |                     |
|                                                                                                                            |   |                     |
| > EXPLAIN (ANALYZE)                                                                                                        |   |                     |
| > SELECT noindex FROM users WHERE noindex = 'xx';                                                                          |   |                     |
| QUERY PLAN                                                                                                                 |   |                     |
| Seq Scan on users  (cost=0.00..2584.00 rows=500 width=516) (actual time=1.908..1.908 rows=0.00 loops=1)                    |   |                     |
| Filter: ((noindex)::text = 'xx'::text)                                                                                     |   |                     |
| Rows Removed by Filter: 100000                                                                                             |   |                     |
| Buffers: shared hit=1334                                                                                                   |   |                     |
| Planning:                                                                                                                  |   |                     |
| Buffers: shared hit=251 read=21                                                                                            |   |                     |
| Planning Time: 0.296 ms                                                                                                    |   |                     |
| Execution Time: 1.913 ms                                                                                                   |   |                     |
|                                                                                                                            |   |                     |
| > EXPLAIN (ANALYZE)                                                                                                        |   |                     |
| > SELECT name1 FROM users WHERE name1 = 'xx';                                                                              |   |                     |
| QUERY PLAN                                                                                                                 |   |                     |
| Bitmap Heap Scan on users  (cost=28.29..1010.49 rows=500 width=516) (actual time=0.019..0.019 rows=0.00 loops=1)           |   |                     |
| Recheck Cond: ((name1)::text = 'xx'::text)                                                                                 |   |                     |
| Buffers: shared read=3                                                                                                     |   |                     |
| ->  Bitmap Index Scan on idx_users_name1  (cost=0.00..28.17 rows=500 width=0) (actual time=0.017..0.017 rows=0.00 loops=1) |   |                     |
| Index Cond: ((name1)::text = 'xx'::text)                                                                                   |   |                     |
| Index Searches: 1                                                                                                          |   |                     |
| Buffers: shared read=3                                                                                                     |   |                     |
| Planning Time: 0.037 ms                                                                                                    |   |                     |
| Execution Time: 0.023 ms                                                                                                   |   |                     |
</pre>
</div>

 <ul class="org-ul"> <li>index使用時の計画時間が、indexが1つだけのときに比べて3倍になった</li>
 <li>index使用時の実行時間は、indexが1つだけのときと変わらない</li>
 <li>index不使用時の計画時間は増加していない</li>
</ul></div>
</div>
 <div id="outline-container-org57f717b" class="outline-3">
 <h3 id="org57f717b"> <a href="#org57f717b">挿入時のコスト</a></h3>
 <div class="outline-text-3" id="text-org57f717b">
 <p>
インデックスの有無を変えてレコードを挿入したときの時間を見る。
</p>

 <div class="org-src-container">
 <pre class="src src-sql"> <span class="org-keyword">CREATE</span>  <span class="org-keyword">TABLE</span>  <span class="org-function-name">users</span> (
     <span class="org-keyword">name</span>  <span class="org-type">varchar</span>(255)
);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">インデックスなしで挿入する
</span> <span class="org-keyword">BEGIN</span>;
EXPLAIN ANALYZE
 <span class="org-keyword">INSERT</span>  <span class="org-keyword">INTO</span> users ( <span class="org-keyword">name</span>)
 <span class="org-keyword">SELECT</span>
      <span class="org-comment-delimiter">-- </span> <span class="org-comment">32x2 文字
</span>     md5(random()::text) || md5(random()::text)
 <span class="org-keyword">FROM</span> generate_series(1, 100000) i;
 <span class="org-keyword">ROLLBACK</span>;

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">インデックスを追加する
</span> <span class="org-keyword">CREATE</span> INDEX idx_users_name  <span class="org-keyword">ON</span> users( <span class="org-keyword">name</span>);

 <span class="org-comment-delimiter">-- </span> <span class="org-comment">インデックスありで挿入する
</span> <span class="org-keyword">BEGIN</span>;
EXPLAIN ANALYZE
 <span class="org-keyword">INSERT</span>  <span class="org-keyword">INTO</span> users ( <span class="org-keyword">name</span>)
 <span class="org-keyword">SELECT</span>
      <span class="org-comment-delimiter">-- </span> <span class="org-comment">32x2 文字
</span>     md5(random()::text) || md5(random()::text)
 <span class="org-keyword">FROM</span> generate_series(1, 100000) i;
 <span class="org-keyword">ROLLBACK</span>;
</pre>
</div>

 <div class="org-src-container">
 <pre class="src src-nil">|                                                                                                                                      |   |                     |
|--------------------------------------------------------------------------------------------------------------------------------------+---+---------------------|
| > CREATE TABLE users (                                                                                                               |   |                     |
| >     name varchar(255)                                                                                                              |   |                     |
| > );                                                                                                                                 |   |                     |
| CREATE TABLE                                                                                                                         |   |                     |
|                                                                                                                                      |   |                     |
| > BEGIN;                                                                                                                             |   |                     |
| BEGIN                                                                                                                                |   |                     |
|                                                                                                                                      |   |                     |
| > EXPLAIN ANALYZE                                                                                                                    |   |                     |
| > INSERT INTO users (name)                                                                                                           |   |                     |
| > SELECT                                                                                                                             |   |                     |
| >      -- 32x2 文字                                                                                                                  |   |                     |
| >      md5(random()::text)                                                                                                           |   | md5(random()::text) |
| > FROM generate_series(1, 100000) i;                                                                                                 |   |                     |
| QUERY PLAN                                                                                                                           |   |                     |
| Insert on users  (cost=0.00..3500.00 rows=0 width=0) (actual time=118.697..118.698 rows=0.00 loops=1)                                |   |                     |
| Buffers: shared hit=102466 dirtied=1236 written=1238                                                                                 |   |                     |
| ->  Subquery Scan on "*SELECT*"  (cost=0.00..3500.00 rows=100000 width=516) (actual time=2.688..88.235 rows=100000.00 loops=1)         |   |                     |
| ->  Function Scan on generate_series i  (cost=0.00..3250.00 rows=100000 width=32) (actual time=2.687..83.525 rows=100000.00 loops=1) |   |                     |
| Planning:                                                                                                                            |   |                     |
| Buffers: shared hit=6                                                                                                                |   |                     |
| Planning Time: 0.032 ms                                                                                                              |   |                     |
| Execution Time: 118.892 ms                                                                                                           |   |                     |
|                                                                                                                                      |   |                     |
| > ROLLBACK;                                                                                                                          |   |                     |
| ROLLBACK                                                                                                                             |   |                     |
|                                                                                                                                      |   |                     |
| > CREATE INDEX idx_users_name ON users(name);                                                                                        |   |                     |
| CREATE INDEX                                                                                                                         |   |                     |
|                                                                                                                                      |   |                     |
| > BEGIN;                                                                                                                             |   |                     |
| BEGIN                                                                                                                                |   |                     |
|                                                                                                                                      |   |                     |
| > EXPLAIN ANALYZE                                                                                                                    |   |                     |
| > INSERT INTO users (name)                                                                                                           |   |                     |
| > SELECT                                                                                                                             |   |                     |
| >      -- 32x2 文字                                                                                                                  |   |                     |
| >      md5(random()::text)                                                                                                           |   | md5(random()::text) |
| > FROM generate_series(1, 100000) i;                                                                                                 |   |                     |
| QUERY PLAN                                                                                                                           |   |                     |
| Insert on users  (cost=0.00..3500.00 rows=0 width=0) (actual time=267.753..267.753 rows=0.00 loops=1)                                |   |                     |
| Buffers: shared hit=398873 read=1 dirtied=2766 written=2765                                                                          |   |                     |
| ->  Subquery Scan on "*SELECT*"  (cost=0.00..3500.00 rows=100000 width=516) (actual time=2.510..91.734 rows=100000.00 loops=1)         |   |                     |
| ->  Function Scan on generate_series i  (cost=0.00..3250.00 rows=100000 width=32) (actual time=2.509..86.862 rows=100000.00 loops=1) |   |                     |
| Planning Time: 0.027 ms                                                                                                              |   |                     |
| Execution Time: 267.930 ms                                                                                                           |   |                     |
|                                                                                                                                      |   |                     |
| > ROLLBACK;                                                                                                                          |   |                     |
| ROLLBACK                                                                                                                             |   |                     |
</pre>
</div>

 <p>
Execution Time が 118.892 ms -> 267.930 ms 。
</p>

 <p>
10万レコード挿入の実行時間が2倍になった。
</p>
</div>
</div>
</div>
 <div id="outline-container-orgc69d2ad" class="outline-2">
 <h2 id="orgc69d2ad"> <a href="#orgc69d2ad">関連</a></h2>
 <div class="outline-text-2" id="text-orgc69d2ad">
 <ul class="org-ul"> <li>疑問: 計画時にオプション評価のコストがかかるというが、どのような状況で問題になるのだろうか。もっと端的に増えていくケースがあるのだろうか。調べた限りだとオーバーヘッドになっているのは確かだが、実行時間の削減量に比べてわずかで、あまり問題となるように見えない</li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251210T084437--kdoc-501-インデックスのオーバーヘッドを検証する__permanent.html"/>
  <id>https://kijimad.github.io/roam/20251210T084437--kdoc-501-インデックスのオーバーヘッドを検証する__permanent.html</id>
  <updated>2025-12-22T17:09:37+09:00</updated>
</entry>
<entry>
  <title>KDOC 516: 2025年をまとめる</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-org6a3a035" class="outline-2">
 <h2 id="org6a3a035"> <a href="#org6a3a035">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-org6a3a035">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul> <ul class="org-ul"> <li>レビュー
 <ul class="org-ul"> <li class="off"> <input type="checkbox"></input> <署名></li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-orgd6c69ff" class="outline-2">
 <h2 id="orgd6c69ff"> <a href="#orgd6c69ff">概要</a></h2>
 <div class="outline-text-2" id="text-orgd6c69ff">
 <p>
メモから思い出す。
</p>

 <p>
個人的イベント。
</p>
</div>
</div>
 <div id="outline-container-org66792f0" class="outline-2">
 <h2 id="org66792f0"> <a href="#org66792f0">関連</a></h2>
 <div class="outline-text-2" id="text-org66792f0">
 <ul class="org-ul"> <li> <a href="20240203T020208--kdoc-67-2023年をまとめる__essay.html#ID-20240203T020208">KDOC 67: 2023年をまとめる</a>
 <ul class="org-ul"> <li>2024年は抜けていることに気づいた</li>
</ul></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251221T163444--kdoc-516-2025年をまとめる__draft_essay.html"/>
  <id>https://kijimad.github.io/roam/20251221T163444--kdoc-516-2025年をまとめる__draft_essay.html</id>
  <updated>2025-12-22T17:09:34+09:00</updated>
</entry>
<entry>
  <title>KDOC 498: 絶滅メディア博物館を観察する</title>
  <author><name>kijimaD</name></author>
  <content type="html"><![CDATA[<div id="content" class="content">

 <div id="outline-container-orgbece72a" class="outline-2">
 <h2 id="orgbece72a"> <a href="#orgbece72a">この文書のステータス</a></h2>
 <div class="outline-text-2" id="text-orgbece72a">
 <ul class="org-ul"> <li>作成
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-15 貴島</li>
</ul></li>
 <li>レビュー
 <ul class="org-ul"> <li class="on"> <input type="checkbox" checked="checked"></input> 2025-12-15 貴島</li>
</ul></li>
</ul></div>
</div>
 <div id="outline-container-org25c9f2b" class="outline-2">
 <h2 id="org25c9f2b"> <a href="#org25c9f2b">概要</a></h2>
 <div class="outline-text-2" id="text-org25c9f2b">
 <p>
絶滅メディア博物館は、東京都千代田区にある博物館である。
</p>

 <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d895.7287805120283!2d139.76786299441568!3d35.68951879196432!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60188d7f2e9513d1%3A0x22e77b7e3001a812!2sExtinct%20Media%20Museum!5e1!3m2!1sen!2sjp!4v1765195098606!5m2!1sen!2sjp" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
</div>
</div>
 <div id="outline-container-org37e6418" class="outline-2">
 <h2 id="org37e6418"> <a href="#org37e6418">メモ</a></h2>
 <div class="outline-text-2" id="text-org37e6418">
 <ul class="org-ul"> <li>各時代のメディアが数多く展示されている。手に持ったり、手で触れてボタンを押して試せる。これがほかの博物館ともっとも異なる点である</li>
 <li>古文書を読めるコーナーがある。古い東京の写真集や雑誌が大量にあって、手にとって読めるのは面白い体験だった</li>
 <li>たくさんの種類のガラケーがあって、当時はそうだった、と思い出した。いろいろな個性ある機種があって、携帯ショップを見るのは楽しかった。今は携帯端末は基本的にすべて同じ形状で、ささやかな違いがあるにすぎない。ショップで見る面白さは少なくなった。このパターンは、多くの博物館で見てきたものに見える。ある時期に、過剰ともいえるようなさまざまな種別が生まれるが、ある時期で収束して違いはなくなっていく。自動車/自転車/カメラ…</li>
 <li>さらに興味がある人むけに、ほかの専門的な博物館へのリンクも随所にあった。たとえば <a href="20250831T135810--kdoc-433-カメラ博物館を観察する__essay.html#ID-20250831T135810">KDOC 433: カメラ博物館を観察する</a>のカメラ博物館もあった。次のアクションを示してくれるのはよいと感じた</li>
 <li>熱意のある個人の収集愛、脱力感を感じた。全国のリサイクルショップをまわって収集しているのだという。まさに目指している姿に近い、個人が運営する博物館なのではないか</li>
</ul></div>
</div>
 <div id="outline-container-org2b5e849" class="outline-2">
 <h2 id="org2b5e849"> <a href="#org2b5e849">関連</a></h2>
 <div class="outline-text-2" id="text-org2b5e849">
 <ul class="org-ul"> <li>アイデア: 人通りがあるエリアで簡単に展示できて、金まわりもやってくれるとしたら、個人的な博物館はもっと増えるのではないだろうかと考えた。本人がやるのは物を運び入れて、並べることだけである。美術館などの企画展示コーナーはあるが、そもそも人通りがなかったり煩雑だったりする。レンタルスペースや中野ブロードウェイのニュアンスだが、販売目的でなく入場料ベースなのが異なる</li>
</ul></div>
</div>
 <div id="outline-container-orgcfd00f6" class="outline-2">
 <h2 id="orgcfd00f6"> <a href="#orgcfd00f6">Backlinks</a></h2>
 <div class="outline-text-2" id="text-orgcfd00f6">
 <ul class="org-ul"> <li> <a href="./20240908T180537--kdoc-238-他人の博物館を観察して参考にする__project.html">KDOC 238: 他人の博物館を観察して参考にする</a></li>
</ul></div>
</div>
</div>]]></content>
  <link href="https://kijimad.github.io/roam/20251207T143600--kdoc-498-絶滅メディア博物館を観察する__essay.html"/>
  <id>https://kijimad.github.io/roam/20251207T143600--kdoc-498-絶滅メディア博物館を観察する__essay.html</id>
  <updated>2025-12-22T17:09:32+09:00</updated>
</entry>
</feed>
